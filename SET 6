CREATE TABLE SAILORS (
  sid INTEGER PRIMARY KEY,
  sname VARCHAR2(20),
  age NUMBER(4,1),
  rating NUMBER
);
CREATE TABLE BOATS (
  bid INTEGER PRIMARY KEY,
  bname VARCHAR2(20),
  color VARCHAR2(20)
);
CREATE TABLE RESERVES (
  sid INTEGER,
  bid INTEGER,
  day DATE,
  FOREIGN KEY (sid) REFERENCES SAILORS(sid),
  FOREIGN KEY (bid) REFERENCES BOATS(bid)
);





ALTER TABLE SAILORS
ADD CONSTRAINT unique_rating UNIQUE (rating);



SELECT *
FROM SAILORS
WHERE rating > ALL (SELECT rating FROM SAILORS WHERE sname = 'Horatio');

SELECT *
FROM SAILORS
WHERE rating = (SELECT MAX(rating) FROM SAILORS);

SELECT S.sname
FROM SAILORS S
JOIN RESERVES R ON S.sid = R.sid
GROUP BY S.sname
HAVING COUNT(DISTINCT R.bid) >= 2;


